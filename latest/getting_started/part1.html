<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Part I: The Panel &mdash; azcausal 0.2.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/logo.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=938c9ccc"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Part II: The Treatment Effect" href="part2.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#PyPi">PyPi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#Github">Github</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#Development">Development</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#Version">Version</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Part I: The Panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="part2.html">Part II: The Treatment Effect</a></li>
<li class="toctree-l2"><a class="reference internal" href="part3.html">Part III: Analysis &amp; Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../estimators/estimators.html">Estimators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../estimators/did.html">Difference-in-Difference (DID)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../estimators/did.html#Panel">Panel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../estimators/did.html#Regression">Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../estimators/did.html#Event-Study">Event Study</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../estimators/sdid.html">Synthetic Difference-in-Difference (SDID)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../estimators/snn.html">Synthetic Nearest Neighbor (SNN)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../error.html">Error</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../error.html#Bootstrap">Bootstrap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error.html#Random">Random</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error.html#Stratified">Stratified</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error.html#Bayes">Bayes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error.html#Placebo">Placebo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error.html#JackKnife">JackKnife</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../power.html">Power Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallelization.html">Parallelization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../parallelization.html#Serial">Serial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallelization.html#Pool">Pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallelization.html#Joblib">Joblib</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">azcausal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="getting_started.html">Getting Started</a></li>
      <li class="breadcrumb-item active">Part I: The Panel</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/amazon-science/azcausal/blob/main/docs/source/getting_started/part1.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Part-I:-The-Panel">
<h1>Part I: The Panel<a class="headerlink" href="#Part-I:-The-Panel" title="Link to this heading"></a></h1>
<p>The very first step before doing any causal inference is get loading the data and tranforming them in the right format. Most estimators in this framework require the data to be in form of a <code class="docutils literal notranslate"><span class="pre">Panel</span></code> object.</p>
<p>Assuming we have the following data frame representing the <code class="docutils literal notranslate"><span class="pre">CaliforniaProp99</span></code> information:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azcausal.data</span> <span class="kn">import</span> <span class="n">CaliforniaProp99</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">CaliforniaProp99</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Year</th>
      <th>PacksPerCapita</th>
      <th>treated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>1970</td>
      <td>89.800003</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arkansas</td>
      <td>1970</td>
      <td>100.300003</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Colorado</td>
      <td>1970</td>
      <td>124.800003</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Connecticut</td>
      <td>1970</td>
      <td>120.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Delaware</td>
      <td>1970</td>
      <td>155.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1204</th>
      <td>Virginia</td>
      <td>2000</td>
      <td>96.699997</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1205</th>
      <td>West Virginia</td>
      <td>2000</td>
      <td>107.900002</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1206</th>
      <td>Wisconsin</td>
      <td>2000</td>
      <td>80.099998</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1207</th>
      <td>Wyoming</td>
      <td>2000</td>
      <td>90.500000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1208</th>
      <td>California</td>
      <td>2000</td>
      <td>41.599998</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1209 rows × 4 columns</p>
</div></div>
</div>
<p>In this example, the columns represent the following:</p>
<ul class="simple">
<li><p>The <strong>units</strong>: are given by each state (<code class="docutils literal notranslate"><span class="pre">State</span></code>)</p></li>
<li><p>The <strong>time</strong>: is represented in years (<code class="docutils literal notranslate"><span class="pre">Year</span></code>)</p></li>
<li><p>The <strong>outcome</strong> is the number of packs sold (<code class="docutils literal notranslate"><span class="pre">PacksPerCapita</span></code>)</p></li>
<li><p>The <strong>intervention</strong> is indicated by the binary treatment column (<code class="docutils literal notranslate"><span class="pre">treated</span></code>)</p></li>
</ul>
<p>We define a <code class="docutils literal notranslate"><span class="pre">Panel</span></code> as a data frame where the index represents <code class="docutils literal notranslate"><span class="pre">time</span></code> and each column a <code class="docutils literal notranslate"><span class="pre">unit</span></code>. We can extract the <code class="docutils literal notranslate"><span class="pre">outcome</span></code> from the data frame by:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azcausal.util</span> <span class="kn">import</span> <span class="n">to_matrix</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">to_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">,</span> <span class="s2">&quot;PacksPerCapita&quot;</span><span class="p">)</span>

<span class="n">outcome</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>State</th>
      <th>Alabama</th>
      <th>Arkansas</th>
      <th>California</th>
      <th>Colorado</th>
      <th>Connecticut</th>
      <th>Delaware</th>
      <th>Georgia</th>
      <th>Idaho</th>
      <th>Illinois</th>
      <th>Indiana</th>
      <th>...</th>
      <th>South Carolina</th>
      <th>South Dakota</th>
      <th>Tennessee</th>
      <th>Texas</th>
      <th>Utah</th>
      <th>Vermont</th>
      <th>Virginia</th>
      <th>West Virginia</th>
      <th>Wisconsin</th>
      <th>Wyoming</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1970</th>
      <td>89.800003</td>
      <td>100.300003</td>
      <td>123.0</td>
      <td>124.800003</td>
      <td>120.000000</td>
      <td>155.000000</td>
      <td>109.900002</td>
      <td>102.400002</td>
      <td>124.800003</td>
      <td>134.600006</td>
      <td>...</td>
      <td>103.599998</td>
      <td>92.699997</td>
      <td>99.800003</td>
      <td>106.400002</td>
      <td>65.500000</td>
      <td>122.599998</td>
      <td>124.300003</td>
      <td>114.5</td>
      <td>106.400002</td>
      <td>132.199997</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>95.400002</td>
      <td>104.099998</td>
      <td>121.0</td>
      <td>125.500000</td>
      <td>117.599998</td>
      <td>161.100006</td>
      <td>115.699997</td>
      <td>108.500000</td>
      <td>125.599998</td>
      <td>139.300003</td>
      <td>...</td>
      <td>115.000000</td>
      <td>96.699997</td>
      <td>106.300003</td>
      <td>108.900002</td>
      <td>67.699997</td>
      <td>124.400002</td>
      <td>128.399994</td>
      <td>111.5</td>
      <td>105.400002</td>
      <td>131.699997</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>101.099998</td>
      <td>103.900002</td>
      <td>123.5</td>
      <td>134.300003</td>
      <td>110.800003</td>
      <td>156.300003</td>
      <td>117.000000</td>
      <td>126.099998</td>
      <td>126.599998</td>
      <td>149.199997</td>
      <td>...</td>
      <td>118.699997</td>
      <td>103.000000</td>
      <td>111.500000</td>
      <td>108.599998</td>
      <td>71.300003</td>
      <td>138.000000</td>
      <td>137.000000</td>
      <td>117.5</td>
      <td>108.800003</td>
      <td>140.000000</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 39 columns</p>
</div></div>
</div>
<p>To check whether the panel data are in fact balanced (we have an entry during each time step for each unit), we can check for <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values in the data frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Is Balanced:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">~</span><span class="n">outcome</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Is Balanced: True
</pre></div></div>
</div>
<p>Let us simulated some data would be missing</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imbalanced</span> <span class="o">=</span> <span class="n">to_matrix</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">,</span> <span class="s2">&quot;PacksPerCapita&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Is Balanced:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">~</span><span class="n">imbalanced</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>

<span class="n">imbalanced</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Is Balanced: False
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>State</th>
      <th>Alabama</th>
      <th>Arkansas</th>
      <th>California</th>
      <th>Colorado</th>
      <th>Connecticut</th>
      <th>Delaware</th>
      <th>Georgia</th>
      <th>Idaho</th>
      <th>Illinois</th>
      <th>Indiana</th>
      <th>...</th>
      <th>South Carolina</th>
      <th>South Dakota</th>
      <th>Tennessee</th>
      <th>Texas</th>
      <th>Utah</th>
      <th>Vermont</th>
      <th>Virginia</th>
      <th>West Virginia</th>
      <th>Wisconsin</th>
      <th>Wyoming</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1970</th>
      <td>89.800003</td>
      <td>100.300003</td>
      <td>123.0</td>
      <td>124.800003</td>
      <td>120.000000</td>
      <td>155.000000</td>
      <td>109.900002</td>
      <td>102.400002</td>
      <td>124.800003</td>
      <td>134.600006</td>
      <td>...</td>
      <td>103.599998</td>
      <td>92.699997</td>
      <td>99.800003</td>
      <td>106.400002</td>
      <td>65.500000</td>
      <td>122.599998</td>
      <td>124.300003</td>
      <td>114.5</td>
      <td>106.400002</td>
      <td>132.199997</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>95.400002</td>
      <td>104.099998</td>
      <td>121.0</td>
      <td>125.500000</td>
      <td>117.599998</td>
      <td>161.100006</td>
      <td>115.699997</td>
      <td>108.500000</td>
      <td>125.599998</td>
      <td>139.300003</td>
      <td>...</td>
      <td>115.000000</td>
      <td>96.699997</td>
      <td>106.300003</td>
      <td>108.900002</td>
      <td>67.699997</td>
      <td>124.400002</td>
      <td>128.399994</td>
      <td>111.5</td>
      <td>105.400002</td>
      <td>131.699997</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>101.099998</td>
      <td>103.900002</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 39 columns</p>
</div></div>
</div>
<p>Instead of extacting only one value at a time, we can also extract multiple directly by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azcausal.util</span> <span class="kn">import</span> <span class="n">to_matrices</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">to_matrices</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">,</span> <span class="s2">&quot;PacksPerCapita&quot;</span><span class="p">,</span> <span class="s2">&quot;treated&quot;</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;PacksPerCapita&#39;, &#39;treated&#39;])
</pre></div></div>
</div>
<p>The reason why we have introduced an object called <code class="docutils literal notranslate"><span class="pre">Panel</span></code> is to combine multiple data frames into one and to have convinient access to information about the time pre and post experiment, as well as control and treatment units. A Panel can be created by passing the <em>outcome</em> and <em>intervention</em> directly as <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azcausal.core.panel</span> <span class="kn">import</span> <span class="n">Panel</span>

<span class="n">outcome</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PacksPerCapita&#39;</span><span class="p">]</span>
<span class="n">intervention</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;treated&#39;</span><span class="p">]</span>

<span class="n">panel</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">intervention</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">panel</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
╭──────────────────────────────────────────────────────────────────────────────╮
|                                    Panel                                     |
|  Time Periods: 31 (19/12)                                  total (pre/post)  |
|  Units: 39 (38/1)                                       total (contr/treat)  |
╰──────────────────────────────────────────────────────────────────────────────╯
</pre></div></div>
</div>
<p>which is equivalent to</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azcausal.core.panel</span> <span class="kn">import</span> <span class="n">Panel</span>

<span class="n">panel</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="s1">&#39;PacksPerCapita&#39;</span><span class="p">,</span> <span class="n">intervention</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">panel</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
╭──────────────────────────────────────────────────────────────────────────────╮
|                                    Panel                                     |
|  Time Periods: 31 (19/12)                                  total (pre/post)  |
|  Units: 39 (38/1)                                       total (contr/treat)  |
╰──────────────────────────────────────────────────────────────────────────────╯
</pre></div></div>
</div>
<p>The panel allows accessing <code class="docutils literal notranslate"><span class="pre">outcome</span></code> and <code class="docutils literal notranslate"><span class="pre">intervention</span></code> directly trough properties:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">panel</span><span class="o">.</span><span class="n">outcome</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>State</th>
      <th>Alabama</th>
      <th>Arkansas</th>
      <th>California</th>
      <th>Colorado</th>
      <th>Connecticut</th>
      <th>Delaware</th>
      <th>Georgia</th>
      <th>Idaho</th>
      <th>Illinois</th>
      <th>Indiana</th>
      <th>...</th>
      <th>South Carolina</th>
      <th>South Dakota</th>
      <th>Tennessee</th>
      <th>Texas</th>
      <th>Utah</th>
      <th>Vermont</th>
      <th>Virginia</th>
      <th>West Virginia</th>
      <th>Wisconsin</th>
      <th>Wyoming</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1970</th>
      <td>89.800003</td>
      <td>100.300003</td>
      <td>123.0</td>
      <td>124.800003</td>
      <td>120.000000</td>
      <td>155.000000</td>
      <td>109.900002</td>
      <td>102.400002</td>
      <td>124.800003</td>
      <td>134.600006</td>
      <td>...</td>
      <td>103.599998</td>
      <td>92.699997</td>
      <td>99.800003</td>
      <td>106.400002</td>
      <td>65.500000</td>
      <td>122.599998</td>
      <td>124.300003</td>
      <td>114.5</td>
      <td>106.400002</td>
      <td>132.199997</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>95.400002</td>
      <td>104.099998</td>
      <td>121.0</td>
      <td>125.500000</td>
      <td>117.599998</td>
      <td>161.100006</td>
      <td>115.699997</td>
      <td>108.500000</td>
      <td>125.599998</td>
      <td>139.300003</td>
      <td>...</td>
      <td>115.000000</td>
      <td>96.699997</td>
      <td>106.300003</td>
      <td>108.900002</td>
      <td>67.699997</td>
      <td>124.400002</td>
      <td>128.399994</td>
      <td>111.5</td>
      <td>105.400002</td>
      <td>131.699997</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>101.099998</td>
      <td>103.900002</td>
      <td>123.5</td>
      <td>134.300003</td>
      <td>110.800003</td>
      <td>156.300003</td>
      <td>117.000000</td>
      <td>126.099998</td>
      <td>126.599998</td>
      <td>149.199997</td>
      <td>...</td>
      <td>118.699997</td>
      <td>103.000000</td>
      <td>111.500000</td>
      <td>108.599998</td>
      <td>71.300003</td>
      <td>138.000000</td>
      <td>137.000000</td>
      <td>117.5</td>
      <td>108.800003</td>
      <td>140.000000</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 39 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">panel</span><span class="o">.</span><span class="n">intervention</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>State</th>
      <th>Alabama</th>
      <th>Arkansas</th>
      <th>California</th>
      <th>Colorado</th>
      <th>Connecticut</th>
      <th>Delaware</th>
      <th>Georgia</th>
      <th>Idaho</th>
      <th>Illinois</th>
      <th>Indiana</th>
      <th>...</th>
      <th>South Carolina</th>
      <th>South Dakota</th>
      <th>Tennessee</th>
      <th>Texas</th>
      <th>Utah</th>
      <th>Vermont</th>
      <th>Virginia</th>
      <th>West Virginia</th>
      <th>Wisconsin</th>
      <th>Wyoming</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1998</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 39 columns</p>
</div></div>
</div>
<p>Moreover, the method also allows to use the most common <code class="docutils literal notranslate"><span class="pre">pandas</span></code> functions on all data included in the panel directly at once:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for instance only keeping the first 3 units.</span>
<span class="n">new_panel</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>

<span class="n">new_panel</span><span class="o">.</span><span class="n">outcome</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>State</th>
      <th>Alabama</th>
      <th>Arkansas</th>
      <th>California</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1970</th>
      <td>89.800003</td>
      <td>100.300003</td>
      <td>123.0</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>95.400002</td>
      <td>104.099998</td>
      <td>121.0</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>101.099998</td>
      <td>103.900002</td>
      <td>123.5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Also, we can use the <code class="docutils literal notranslate"><span class="pre">get</span></code> method with key word arguments.</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">contr</span> <span class="pre">==</span> <span class="pre">True</span></code> then only control units are returned.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">treat</span> <span class="pre">==</span> <span class="pre">True</span></code> then units which have been treated at least once are returned.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">pre</span> <span class="pre">==</span> <span class="pre">True</span></code> then time steps where no unit is treated is returned.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">post</span> <span class="pre">==</span> <span class="pre">True</span></code> then the time steps where at least one unit is treated.</p></li>
</ul>
<p>, for example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">panel</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">treat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>State</th>
      <th>California</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1989</th>
      <td>82.400002</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>77.800003</td>
    </tr>
    <tr>
      <th>1991</th>
      <td>68.699997</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>For more methods please check the <code class="docutils literal notranslate"><span class="pre">Panel</span></code> immplementation directly.</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">Panel</span></code> it is also relatively easy to plot the average control versus treatment by:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">)})</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">avg_control</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">contr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">avg_treat</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">treat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">avg_control</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">avg_treat</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">panel</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.lines.Line2D at 0x7f93d4026a00&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/getting_started_part1_25_1.png" src="../_images/getting_started_part1_25_1.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="part2.html" class="btn btn-neutral float-right" title="Part II: The Treatment Effect" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Amazon, Julian Blank.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>